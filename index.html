<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Speed Reader - RSVP</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <meta name="theme-color" content="#3b82f6">

    <!-- Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Input Screen -->
    <div id="input-screen" class="screen active">
        <!-- Gallery hint overlay -->
        <div class="gallery-hint-overlay" id="gallery-hint">
            <div class="hint-icon">ğŸ‘‡</div>
            <div class="hint-text" data-i18n="galleryHintText">Swipe down for camera</div>
            <div class="hint-subtext" data-i18n="galleryHintSubtext">or select a photo from your gallery</div>
        </div>

        <div class="header">
            <div class="logo">
                <div class="logo-icon">
                    <img src="logo.png" alt="Speed Reader Logo" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">
                </div>
                <div>
                    <h1 data-i18n="title">Speed Reader</h1>
                    <p class="subtitle" data-i18n="subtitle">RSVP-Technik fÃ¼r schnelleres Lesen</p>
                </div>
            </div>
            <div class="header-controls">
                <button class="theme-toggle" id="theme-toggle" title="Theme wechseln">
                    <span class="theme-icon">ğŸŒ™</span>
                </button>
                <div class="lang-toggle">
                    <button class="lang-btn active" data-lang="de">DE</button>
                    <button class="lang-btn" data-lang="en">EN</button>
                </div>
            </div>
        </div>

        <div class="input-section">
            <!-- Tab Navigation -->
            <div class="tab-nav">
                <button class="tab-btn active" data-tab="text">ğŸ“ <span data-i18n="tabText">Text einfÃ¼gen</span></button>
                <button class="tab-btn" data-tab="file">ğŸ“ <span data-i18n="tabFile">Datei Ã¶ffnen</span></button>
                <button class="tab-btn" data-tab="ocr">ğŸ“· <span data-i18n="tabOCR">Bild scannen</span></button>
            </div>

            <!-- Text Input Tab -->
            <div class="tab-content active" id="tab-text">
                <textarea id="text-input" data-i18n-placeholder="placeholder" placeholder="FÃ¼ge hier deinen Text ein...

Du kannst ganze BÃ¼cher, Artikel oder beliebige Texte einfÃ¼gen. Kapitel werden automatisch erkannt."></textarea>
            </div>

            <!-- File Upload Tab -->
            <div class="tab-content" id="tab-file">
                <div class="upload-zone" id="file-upload-zone">
                    <span class="upload-zone-icon">ğŸ“„</span>
                    <div class="upload-zone-text" data-i18n="fileUploadText">Datei hierher ziehen oder klicken</div>
                    <div class="upload-zone-hint" data-i18n="fileUploadHint">PDF, EPUB, TXT, DOCX werden unterstÃ¼tzt</div>
                    <div class="upload-buttons">
                        <button class="upload-btn primary" id="choose-doc-btn">
                            ğŸ“ <span data-i18n="chooseFile">Datei wÃ¤hlen</span>
                        </button>
                    </div>
                    <div class="file-support">
                        <span class="file-badge">PDF</span>
                        <span class="file-badge">EPUB</span>
                        <span class="file-badge">TXT</span>
                        <span class="file-badge">DOCX</span>
                    </div>
                    <input type="file" id="doc-input" accept=".pdf,.epub,.txt,.docx,.doc">
                </div>

                <div class="file-progress" id="file-progress">
                    <div class="file-status" id="file-status" data-i18n="fileLoading">Datei wird geladen...</div>
                    <div class="progress-bar-ocr">
                        <div class="progress-bar-ocr-fill" id="file-progress-fill"></div>
                    </div>
                </div>

                <div class="ocr-result" id="file-result">
                    <div class="ocr-text-output" id="file-text-output"></div>
                    <div class="ocr-actions">
                        <button class="ocr-action-btn" id="copy-file-btn">ğŸ“‹ <span data-i18n="copyText">Text kopieren</span></button>
                        <button class="ocr-action-btn" id="edit-file-btn">âœï¸ <span data-i18n="editText">Bearbeiten</span></button>
                        <button class="ocr-action-btn primary" id="read-file-btn">â–¶ <span data-i18n="readNow">Jetzt lesen</span></button>
                    </div>
                </div>
            </div>

            <!-- OCR Tab -->
            <div class="tab-content" id="tab-ocr">
                <div class="ocr-container">
                    <div class="ocr-lang-select">
                        <label data-i18n="ocrLang">Textsprache:</label>
                        <select id="ocr-lang">
                            <option value="deu">Deutsch</option>
                            <option value="eng">English</option>
                            <option value="deu+eng">Deutsch + English</option>
                            <option value="fra">FranÃ§ais</option>
                            <option value="spa">EspaÃ±ol</option>
                            <option value="ita">Italiano</option>
                        </select>
                    </div>

                    <div class="upload-zone" id="upload-zone">
                        <span class="upload-zone-icon">ğŸ“·</span>
                        <div class="upload-zone-text" data-i18n="uploadText">Bild hierher ziehen oder klicken</div>
                        <div class="upload-zone-hint" data-i18n="uploadHint">JPG, PNG, WebP â€“ oder Kamera nutzen</div>
                        <div class="upload-buttons">
                            <button class="upload-btn" id="choose-file-btn">
                                ğŸ“ <span data-i18n="chooseImage">Bild wÃ¤hlen</span>
                            </button>
                            <button class="upload-btn primary" id="camera-btn">
                                ğŸ“¸ <span data-i18n="takePhoto">Foto aufnehmen</span>
                            </button>
                        </div>
                        <input type="file" id="file-input" accept="image/png,image/jpeg,image/webp,image/gif">
                        <input type="file" id="camera-input" accept="image/*" capture="environment">
                    </div>

                    <div class="preview-container" id="preview-container">
                        <button class="new-scan-btn" id="new-scan-btn" data-i18n="newScan">â† Neues Bild</button>
                        <img id="image-preview" class="image-preview" alt="Preview">
                    </div>

                    <div class="ocr-progress" id="ocr-progress">
                        <div class="ocr-status" id="ocr-status" data-i18n="ocrLoading">Text wird erkannt...</div>
                        <div class="progress-bar-ocr">
                            <div class="progress-bar-ocr-fill" id="ocr-progress-fill"></div>
                        </div>
                    </div>

                    <div class="ocr-result" id="ocr-result">
                        <div class="ocr-text-output" id="ocr-text-output"></div>
                        <div class="ocr-actions">
                            <button class="ocr-action-btn" id="copy-ocr-btn">ğŸ“‹ <span data-i18n="copyText">Text kopieren</span></button>
                            <button class="ocr-action-btn" id="edit-ocr-btn">âœï¸ <span data-i18n="editText">Bearbeiten</span></button>
                            <button class="ocr-action-btn primary" id="read-ocr-btn">â–¶ <span data-i18n="readNow">Jetzt lesen</span></button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="settings-panel">
                <div class="settings-title">âš™ï¸ <span data-i18n="settings">Einstellungen</span></div>
                <div class="settings-grid">
                    <div class="setting-item">
                        <div class="setting-label">
                            <span data-i18n="speed">Geschwindigkeit</span>
                            <span class="setting-value"><span id="wpm-value">300</span> WPM</span>
                        </div>
                        <input type="range" id="wpm-slider" min="100" max="1000" value="300" step="25">
                    </div>

                    <div class="setting-item">
                        <div class="setting-label">
                            <span data-i18n="chapterPause">Pause bei Kapitel</span>
                            <span class="setting-value"><span id="chapter-pause-value">2</span>s</span>
                        </div>
                        <input type="range" id="chapter-pause-slider" min="0" max="5" value="2" step="0.5">
                    </div>

                    <div class="setting-item">
                        <div class="setting-label">
                            <span data-i18n="sentencePause">Pause bei Satzende</span>
                            <span class="setting-value"><span id="sentence-pause-value">0.3</span>s</span>
                        </div>
                        <input type="range" id="sentence-pause-slider" min="0" max="1" value="0.3" step="0.1">
                    </div>

                    <div class="setting-item">
                        <div class="setting-label">
                            <span data-i18n="longWordBonus">Lange WÃ¶rter verlangsamen</span>
                            <span class="setting-value"><span id="long-word-value">10</span>ms</span>
                        </div>
                        <input type="range" id="long-word-slider" min="0" max="100" value="10" step="5">
                    </div>

                    <div class="setting-item">
                        <div class="setting-label">
                            <span data-i18n="longWordThreshold">Ab WortlÃ¤nge</span>
                            <span class="setting-value"><span id="long-word-threshold-value">8</span> <span data-i18n="chars">Zeichen</span></span>
                        </div>
                        <input type="range" id="long-word-threshold-slider" min="4" max="12" value="8" step="1">
                    </div>

                    <div class="setting-item">
                        <label class="checkbox-item">
                            <input type="checkbox" id="highlight-center" checked>
                            <span data-i18n="highlight">Fokuspunkt hervorheben</span>
                        </label>
                    </div>
                </div>
            </div>

            <button class="start-btn" id="start-btn" data-i18n="start" disabled>â–¶ Lesen starten</button>
        </div>
    </div>

    <!-- Reader Screen -->
    <div id="reader-screen" class="screen">
        <button class="back-btn" id="back-btn" data-i18n="back">â† ZurÃ¼ck</button>

        <div class="lang-toggle lang-toggle-reader">
            <button class="theme-toggle" id="theme-toggle-reader" title="Theme wechseln">
                <span class="theme-icon">ğŸŒ™</span>
            </button>
            <button class="lang-btn active" data-lang="de">DE</button>
            <button class="lang-btn" data-lang="en">EN</button>
        </div>

        <div class="keyboard-hints">
            <kbd>Space</kbd> <span data-i18n="hintPlayPause">Play/Pause</span><br>
            <kbd>â†</kbd> <span data-i18n="hintBack">ZurÃ¼ck</span><br>
            <kbd>â†’</kbd> <span data-i18n="hintForward">VorwÃ¤rts</span><br>
            <kbd>â†‘</kbd> <span data-i18n="hintFaster">Schneller</span><br>
            <kbd>â†“</kbd> <span data-i18n="hintSlower">Langsamer</span>
        </div>

        <div class="word-display-container">
            <div class="word-display" id="word-display" data-i18n="ready">Bereit</div>
        </div>
        <div class="chapter-indicator" id="chapter-indicator"></div>

        <div class="controls">
            <div class="progress-bar" id="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>

            <div class="control-buttons">
                <button class="ctrl-btn" id="jump-back-btn" title="10 WÃ¶rter zurÃ¼ck">âª</button>
                <button class="ctrl-btn" id="prev-btn" title="1 Wort zurÃ¼ck">â—€</button>
                <button class="ctrl-btn play-pause" id="play-pause-btn" title="Play/Pause">â–¶</button>
                <button class="ctrl-btn" id="next-btn" title="1 Wort vor">â–¶</button>
                <button class="ctrl-btn" id="jump-forward-btn" title="10 WÃ¶rter vor">â©</button>
            </div>

            <div class="word-counter" id="word-counter">0 / 0</div>

            <div class="speed-display">
                <button class="speed-adjust" id="speed-down">âˆ’</button>
                <span><span id="current-wpm">300</span> WPM</span>
                <button class="speed-adjust" id="speed-up">+</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <!-- App Script (ES Module) -->
    <script type="module" src="js/app.js"></script>
</body>
</html>
